<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>How to use React-Router with the react start kit !</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <link href="/assets/css/style.css?bust=1446472123" rel="stylesheet">
    <script src="/assets/js/modernizr.min.js?bust=1446472123"></script>
    
      <meta name="description" content="See how to use react-router with the react-starter-kit." />
    
  </head>
  <body  >

    <div class="sidebar clear">
      <div class="sidebar__profile">
        <a href="/">
          <img src="/assets/img/flo.jpg" alt="Cabirol Florian" class="sidebar__profile-img">
        </a>
        <h1 class="sidebar__profile-name">
          Cabirol Florian
        </h1>
        <div class="sidebar__profile-bio clear">
          <p>
            <b>Freelancer in Lyon, France.</b><br>
            Currently in <b>computer 5th engineering school.</b><br>
            Web development Lover. <br>
            PHP, Javascript, NodeJs. <br>
            Symfony, Mysql, NodeJs, MongoDB.<br>
          </p>
        </div>
        <nav class="sidebar__profile-nav">
          <ul>
            <li>
              <a href="/">
                Posts
              </a>
            </li><!--
            --><li>
              <a href="/about">
                About
              </a>
            </li><!--
            --><li>
              <a href="/feed.xml">
                RSS
              </a>
            </li>
          </ul>
        </nav>
        <div class="social__wrapper">
            <div class="social-link" title="Twitter"><a href="//www.twitter.com/wedevelopp"> <i class="fa fa-twitter"></i> </a> </div>
            <div class="social-link" title="GitHub"><a href="//www.github.com/thatcheck"> <i class="fa fa-github"></i> </a></div>
            <div class="social-link" title="Linkedin"><a href="//www.linkedin.com/in/cabirolflorian"> <i class="fa fa-linkedin"></i> </a></div>
        </div>
      </div>
    </div>


    <div class="main" role="main">
          <article class="post clear">
      <h1 class="post__title">
        How to use React-Router with the react start kit !
      </h1>
      <div class="post__meta">
        
        <a class="post__meta-edit" href="//github.com/thatcheck/thatcheck.github.io/blob/develop/_posts/2015-10-28-Use-React-Router-React-Starter-Kit.markdown">
          <i class="fa fa-github"></i>
          Edit this page on GitHub
        </a>
        
        <p>
          October 28, 2015
        </p>
      </div>

      <p>Today we will see how to use <a href="https://github.com/rackt/react-router">react-router</a> with the <a href="https://github.com/kriasoft/react-starter-kit">react-starter-kit</a>. The routing tool in the react-starter-kit doesnâ€™t fit my needs, so I decided to install the react-router.</p>

<p>I just write a little tutorial to help you if you have some problems with the installation too.</p>

<h2 id="installation">Installation</h2>
<p>First of all, we need to download the react-router</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">npm install --save react-router</code></pre></div>

<p>After, go to the src/app.js and use replace the <code>run</code> function with this :</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="cm">/**</span>
<span class="cm">  * Add the specialized context to the router (useful to inject some High order Element)</span>
<span class="cm">  * @param Component</span>
<span class="cm">  * @param props</span>
<span class="cm">  * @returns {XML}</span>
<span class="cm">  */</span>
 <span class="kd">function</span> <span class="nx">createElement</span><span class="p">(</span><span class="nx">Component</span><span class="p">,</span> <span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">props</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">specializedContext</span> <span class="o">=</span> <span class="nx">context</span><span class="p">;</span>
   <span class="k">return</span> <span class="o">&lt;</span><span class="nx">Component</span> <span class="p">{...</span><span class="nx">props</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">;</span>
 <span class="p">}</span>
 
 <span class="cm">/**</span>
<span class="cm">  * Main entry point for the react client app</span>
<span class="cm">  */</span>
 <span class="kd">function</span> <span class="nx">run</span><span class="p">()</span> <span class="p">{</span>
   <span class="nx">FastClick</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span>
 
   <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
     <span class="o">&lt;</span><span class="nx">Router</span> <span class="nx">routes</span><span class="o">=</span><span class="p">{</span><span class="nx">routes</span><span class="p">}</span> <span class="nx">history</span><span class="o">=</span><span class="p">{</span><span class="nx">history</span><span class="p">}</span> <span class="nx">createElement</span><span class="o">=</span><span class="p">{</span><span class="nx">createElement</span><span class="p">}</span> <span class="o">/&gt;</span><span class="p">,</span>
     <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;app&#39;</span><span class="p">)</span>
   <span class="p">);</span>
 <span class="p">}</span></code></pre></div>

<p>Replace the src/routes.js with :</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
 <span class="kr">import</span> <span class="nx">App</span> <span class="nx">from</span> <span class="s1">&#39;./components/App&#39;</span><span class="p">;</span>
 <span class="kr">import</span> <span class="nx">Home</span> <span class="nx">from</span> <span class="s1">&#39;./components/Homepage/Homepage.js&#39;</span><span class="p">;</span>
 
 <span class="kr">import</span> <span class="p">{</span><span class="nx">Route</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router&#39;</span><span class="p">;</span>
 
 <span class="kr">export</span> <span class="k">default</span> <span class="p">(</span>
   <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">App</span><span class="p">}</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Home</span><span class="p">}</span><span class="o">/&gt;</span>
   <span class="o">&lt;</span><span class="err">/Route&gt;</span>
 <span class="p">);</span></code></pre></div>

<p>Replace in src/server.js :</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">await</span> <span class="nx">Router</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">({</span> <span class="nx">path</span><span class="o">:</span> <span class="nx">req</span><span class="p">.</span><span class="nx">path</span><span class="p">,</span> <span class="nx">context</span> <span class="p">},</span> <span class="p">(</span><span class="nx">state</span><span class="p">,</span> <span class="nx">component</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">data</span><span class="p">.</span><span class="nx">body</span> <span class="o">=</span> <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">renderToString</span><span class="p">(</span><span class="nx">component</span><span class="p">);</span>
      <span class="nx">data</span><span class="p">.</span><span class="nx">css</span> <span class="o">=</span> <span class="nx">css</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="kr">const</span> <span class="nx">html</span> <span class="o">=</span> <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">renderToStaticMarkup</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Html</span> <span class="p">{...</span><span class="nx">data</span><span class="p">}</span> <span class="o">/&gt;</span><span class="p">);</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="nx">statusCode</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;&lt;!doctype html&gt;\n&#39;</span> <span class="o">+</span> <span class="nx">html</span><span class="p">);</span></code></pre></div>

<p>with :</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="cm">/**</span>
<span class="cm">     * Use the react-router match function and add specific context data !</span>
<span class="cm">     * TO-DO : Test error code and clear the code</span>
<span class="cm">     */</span>
    <span class="nx">match</span><span class="p">({</span> <span class="nx">routes</span><span class="p">,</span> <span class="nx">location</span><span class="o">:</span> <span class="nx">req</span><span class="p">.</span><span class="nx">url</span> <span class="p">},</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">redirectLocation</span><span class="p">,</span> <span class="nx">renderProps</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">redirectLocation</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="mi">302</span><span class="p">,</span> <span class="nx">redirectLocation</span><span class="p">.</span><span class="nx">pathname</span> <span class="o">+</span> <span class="nx">redirectLocation</span><span class="p">.</span><span class="nx">search</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">renderProps</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">renderProps</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">specializedContext</span> <span class="o">=</span> <span class="nx">context</span><span class="p">;</span>
        <span class="nx">data</span><span class="p">.</span><span class="nx">body</span> <span class="o">=</span> <span class="nx">renderToString</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">RoutingContext</span> <span class="p">{...</span><span class="nx">renderProps</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">);</span>
        <span class="nx">data</span><span class="p">.</span><span class="nx">css</span> <span class="o">=</span> <span class="nx">css</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
        <span class="kr">const</span> <span class="nx">html</span> <span class="o">=</span> <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">renderToStaticMarkup</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Html</span> <span class="p">{...</span><span class="nx">data</span><span class="p">}</span> <span class="o">/&gt;</span><span class="p">);</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="nx">statusCode</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;&lt;!doctype html&gt;\n&#39;</span> <span class="o">+</span> <span class="nx">html</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Not found&#39;</span><span class="p">);</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="mi">404</span><span class="p">,</span> <span class="s1">&#39;Not found&#39;</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span></code></pre></div>

<p>And finally, the decorator/WithContext.js :</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="cm">/*! React Starter Kit | MIT License | http://www.reactstarterkit.com/ */</span>

<span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">PropTypes</span><span class="p">,</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span> <span class="c1">// eslint-disable-line no-unused-vars</span>
<span class="kr">import</span> <span class="nx">emptyFunction</span> <span class="nx">from</span> <span class="s1">&#39;fbjs/lib/emptyFunction&#39;</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">withContext</span><span class="p">(</span><span class="nx">ComposedComponent</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kr">class</span> <span class="nx">WithContext</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>

    <span class="kr">static</span> <span class="nx">propTypes</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">context</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">shape</span><span class="p">({</span>
        <span class="nx">onInsertCss</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">,</span>
        <span class="nx">onSetTitle</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">,</span>
        <span class="nx">onSetMeta</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">,</span>
        <span class="nx">onPageNotFound</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">,</span>
      <span class="p">}),</span>
    <span class="p">};</span>

    <span class="kr">static</span> <span class="nx">childContextTypes</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">onInsertCss</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">.</span><span class="nx">isRequired</span><span class="p">,</span>
      <span class="nx">onSetTitle</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">.</span><span class="nx">isRequired</span><span class="p">,</span>
      <span class="nx">onSetMeta</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">.</span><span class="nx">isRequired</span><span class="p">,</span>
      <span class="nx">onPageNotFound</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">.</span><span class="nx">isRequired</span><span class="p">,</span>
    <span class="p">};</span>

    <span class="nx">getChildContext</span><span class="p">()</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">context</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">specializedContext</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">context</span><span class="p">;</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="nx">onInsertCss</span><span class="o">:</span> <span class="nx">context</span><span class="p">.</span><span class="nx">onInsertCss</span> <span class="o">||</span> <span class="nx">emptyFunction</span><span class="p">,</span>
        <span class="nx">onSetTitle</span><span class="o">:</span> <span class="nx">context</span><span class="p">.</span><span class="nx">onSetTitle</span> <span class="o">||</span> <span class="nx">emptyFunction</span><span class="p">,</span>
        <span class="nx">onSetMeta</span><span class="o">:</span> <span class="nx">context</span><span class="p">.</span><span class="nx">onSetMeta</span> <span class="o">||</span> <span class="nx">emptyFunction</span><span class="p">,</span>
        <span class="nx">onPageNotFound</span><span class="o">:</span> <span class="nx">context</span><span class="p">.</span><span class="nx">onPageNotFound</span> <span class="o">||</span> <span class="nx">emptyFunction</span><span class="p">,</span>
      <span class="p">};</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="p">{</span> <span class="nx">context</span><span class="p">,</span> <span class="p">...</span><span class="nx">other</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span> <span class="c1">// eslint-disable-line no-unused-vars</span>
      <span class="k">return</span> <span class="o">&lt;</span><span class="nx">ComposedComponent</span> <span class="p">{...</span><span class="nx">other</span><span class="p">}</span> <span class="o">/&gt;</span><span class="p">;</span>
    <span class="p">}</span>

  <span class="p">};</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">withContext</span><span class="p">;</span></code></pre></div>

      <div class="social">
        <div class="social__button">
          <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
        </div>
        <div class="social__button">
          <div id="fb-root"></div>
          <div class="fb-like" data-send="false" data-layout="button_count"
          data-width="1" data-show-faces="false" data-action="like"></div>
        </div>
        <div class="social__button">
          <g:plusone size="medium"></g:plusone>
        </div>
      </div>
      <div class="disqus">
        <div id="disqus_thread"></div>
      </div>
    </article>

    <script>
      var disqus_url = 'http://cabirol-florian.com/react/2015/10/28/Use-React-Router-React-Starter-Kit/';
      var disqus_title = 'How to use React-Router with the react start kit !';
      var disqus_shortname = 'floriancabirol';
      (function() {
        var dsq = document.createElement('script');
        dsq.async = dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        document.getElementsByTagName('head')[0].appendChild(dsq);
      })();
    </script>

    </div>

    <script src="/assets/js/thatcheck.github.io.min.js?bust=1446472123"></script>
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-68669846-1', 'auto');
    ga('send', 'pageview');

</script>
  </body>
</html>
